<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>(Un)marshal a Learner — marshaling • mlr3</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="(Un)marshal a Learner — marshaling"><meta name="description" content='Marshaling is the process of processing the model of a trained Learner so it an be successfully serialized and
deserialized. The naming is inspired by the marshal package and we
plan to fully migrate to this package once it is on CRAN.
The current implementation should therfore be considered as a temporary solution and is likely
to change in the future.
The central functions (and the only methods that are used by mlr3 internally) are:
the S3 generic marshal_model(model, inplace, ...).
Which takes in a model and returns it in marshaled form.
This means, that the resulting object can be serialized and de-serialzed without loss of information.
If a model is serializable anyway, nothing has to be implemented and the generic will fall back to the
default implementation of marshal_model, which is to return the object as-is.
Otherwise, the marshaled object should be a list with named elements marshaled and packages, where the former contains
the marshaled object, and the latter the package that contains the packages required to unmarshal.
Most importantly, this list should contain the package that contains the unmarshal_model method.
The returned object should have the classes of the original object with the suffix "_marshaled" appended and the
root class should be set to "marshaled".
the S3 generic unmarshal_model(model, inplace ...).
Which takes in the marshaled model and returns it in unmarshaled form.
The generic takes care that the packages specified during "marshal" are loaded, and errs if they are not availabe.
Calling this function on a marshaled model should reconstruct the original model, i.e.
unmarshal_model(marshal_model(x)) should return x.
The default implementation of this generic returns x as-is.
the function is_marshaled_model(model).
This (helper) function returns TRUE if the model inherits from class "marshaled" and FALSE otherwise.
Note that it is not guarateed that is_marshaled_model(marshal_model(x)) returns TRUE.
This is because the default marshal_model(x) returns x as-is.


For both marshal_model and unmarshal_model, the inplace argument determines whether in-place marshaling
should be performed. This is especially relevant in the context of references semantics.
If inplace is FALSE, the original input should not be modified, otherwise this is allowed.
Note that the input and output can still share references, even when inplace is FALSE.'><meta property="og:description" content='Marshaling is the process of processing the model of a trained Learner so it an be successfully serialized and
deserialized. The naming is inspired by the marshal package and we
plan to fully migrate to this package once it is on CRAN.
The current implementation should therfore be considered as a temporary solution and is likely
to change in the future.
The central functions (and the only methods that are used by mlr3 internally) are:
the S3 generic marshal_model(model, inplace, ...).
Which takes in a model and returns it in marshaled form.
This means, that the resulting object can be serialized and de-serialzed without loss of information.
If a model is serializable anyway, nothing has to be implemented and the generic will fall back to the
default implementation of marshal_model, which is to return the object as-is.
Otherwise, the marshaled object should be a list with named elements marshaled and packages, where the former contains
the marshaled object, and the latter the package that contains the packages required to unmarshal.
Most importantly, this list should contain the package that contains the unmarshal_model method.
The returned object should have the classes of the original object with the suffix "_marshaled" appended and the
root class should be set to "marshaled".
the S3 generic unmarshal_model(model, inplace ...).
Which takes in the marshaled model and returns it in unmarshaled form.
The generic takes care that the packages specified during "marshal" are loaded, and errs if they are not availabe.
Calling this function on a marshaled model should reconstruct the original model, i.e.
unmarshal_model(marshal_model(x)) should return x.
The default implementation of this generic returns x as-is.
the function is_marshaled_model(model).
This (helper) function returns TRUE if the model inherits from class "marshaled" and FALSE otherwise.
Note that it is not guarateed that is_marshaled_model(marshal_model(x)) returns TRUE.
This is because the default marshal_model(x) returns x as-is.


For both marshal_model and unmarshal_model, the inplace argument determines whether in-place marshaling
should be performed. This is especially relevant in the context of references semantics.
If inplace is FALSE, the original input should not be modified, otherwise this is allowed.
Note that the input and output can still share references, even when inplace is FALSE.'><meta property="og:image" content="https://mlr3.mlr-org.com/logo.svg"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mlr3</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-alt"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr3book.mlr-org.com"><span class="fa fa-link"></span> mlr3book</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlr-org/mlr3/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/"><span class="fa fa-comments"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr3"><span class="fa fab fa-stack-overflow"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr-org.com/"><span class="fa fa-rss"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>(Un)marshal a Learner</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr3/blob/main/R/marshal.R" class="external-link"><code>R/marshal.R</code></a></small>
      <div class="d-none name"><code>marshaling.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Marshaling is the process of processing the model of a trained <code><a href="Learner.html">Learner</a></code> so it an be successfully serialized and
deserialized. The naming is inspired by the <a href="https://github.com/futureverse/marshal" class="external-link">marshal package</a> and we
plan to fully migrate to this package once it is on CRAN.
The current implementation should therfore be considered as a temporary solution and is likely
to change in the future.</p>
<p>The central functions (and the only methods that are used by <code>mlr3</code> internally) are:</p><ul><li><p>the S3 generic <code>marshal_model(model, inplace, ...)</code>.
Which takes in a model and returns it in marshaled form.
This means, that the resulting object can be serialized and de-serialzed without loss of information.
If a model is serializable anyway, nothing has to be implemented and the generic will fall back to the
default implementation of <code>marshal_model</code>, which is to return the object as-is.
Otherwise, the marshaled object should be a list with named elements <code>marshaled</code> and <code>packages</code>, where the former contains
the marshaled object, and the latter the package that contains the packages required to unmarshal.
Most importantly, this list should contain the package that contains the <code>unmarshal_model</code> method.
The returned object should have the classes of the original object with the suffix <code>"_marshaled"</code> appended and the
root class should be set to <code>"marshaled"</code>.</p></li>
<li><p>the S3 generic <code>unmarshal_model(model, inplace ...)</code>.
Which takes in the marshaled model and returns it in unmarshaled form.
The generic takes care that the packages specified during <code>"marshal"</code> are loaded, and errs if they are not availabe.
Calling this function on a marshaled model should reconstruct the original model, i.e.
<code>unmarshal_model(marshal_model(x))</code> should return <code>x</code>.
The default implementation of this generic returns <code>x</code> as-is.</p></li>
<li><p>the function <code>is_marshaled_model(model)</code>.
This (helper) function returns <code>TRUE</code> if the model inherits from class <code>"marshaled"</code> and <code>FALSE</code> otherwise.
Note that it is not guarateed that <code>is_marshaled_model(marshal_model(x))</code> returns <code>TRUE</code>.
This is because the default <code>marshal_model(x)</code> returns <code>x</code> as-is.</p></li>
</ul><p>For both <code>marshal_model</code> and <code>unmarshal_model</code>, the <code>inplace</code> argument determines whether in-place marshaling
should be performed. This is especially relevant in the context of references semantics.
If <code>inplace</code> is <code>FALSE</code>, the original input should not be modified, otherwise this is allowed.
Note that the input and output can still share references, even when <code>inplace</code> is <code>FALSE</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">learner_unmarshal</span><span class="op">(</span><span class="va">.learner</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">learner_marshal</span><span class="op">(</span><span class="va">.learner</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">learner_marshaled</span><span class="op">(</span><span class="va">.learner</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">marshal_model</span><span class="op">(</span><span class="va">model</span>, inplace <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">unmarshal_model</span><span class="op">(</span><span class="va">model</span>, inplace <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">is_marshaled_model</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--learner">.learner<a class="anchor" aria-label="anchor" href="#arg--learner"></a></dt>
<dd><p><code><a href="Learner.html">Learner</a></code><br>
The learner.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>(any)<br>
Additional parameters, currently unused.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>(any)<br>
Model to marshal.</p></dd>


<dt id="arg-inplace">inplace<a class="anchor" aria-label="anchor" href="#arg-inplace"></a></dt>
<dd><p>(<code>logical(1)</code>)<br>
Whether to marshal in-place.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="implementing-marshaling">Implementing Marshaling<a class="anchor" aria-label="anchor" href="#implementing-marshaling"></a></h2>



<p>In order to implement marshaling for a Learner, you need to overload the <code>marshal_model</code> and <code>unmarshal_model</code>
methods for the class of the learner's model and tag the learner with the <code>"marshal"</code> property.
To make marshaling accessible in an R6-manner, you should also add the public methods <code>$marshal()</code>, <code>$unmarshal()</code>
and the active binding <code>$marshaled</code>.
To make this as convenient as possible, the functions <code>learner_marshal(.learner, ...)</code>, <code>learner_unmarshal(.learner, ...)</code>
and <code>learner_marshaled(.learner)</code> are provided and can be called from the public methods.</p>
<p>You can verify whether you have correctly implemented marshaling by using the internal test helper
<code>expect_marshalable_learner(learner, task)</code>. This is also run by <code>expect_learner()</code> if a task is provided.</p>
<p>For a concrete example on how to implement marshaling, see <code><a href="mlr_learners_classif.debug.html">LearnerClassifDebug</a></code>.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michel Lang, Bernd Bischl, Jakob Richter, Patrick Schratz, Martin Binder, Florian Pfisterer, Raphael Sonabend, Marc Becker, Sebastian Fischer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

